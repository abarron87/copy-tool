"use strict";angular.module("bannerCopyToolApp",["ngCookies","ngResource","ngSanitize"]),angular.module("bannerCopyToolApp").factory("banners",function(){var a=[{name:"300x50",width:"300",height:"50",orientation:"landscape",copyType:"short",selected:"short"},{name:"300x250",width:"300",height:"250",orientation:"portrait",copyType:"long",selected:"long"},{name:"300x600",width:"300",height:"600",orientation:"portrait",copyType:"long",selected:"long"},{name:"728x90",width:"728",height:"90",orientation:"landscape",copyType:"long short",selected:"long"}];return{get:function(){return a}}}),angular.module("bannerCopyToolApp").controller("MainCtrl",["$scope","$sce","banners",function(a,b,c){var d={bannersVisible:!0,text:"",sanitize:function(){return b.trustAsHtml(this.text)}};a.copy={"long":angular.extend({},d,{text:'The <em>quick</em> <span style="color:brown;">brown</span> <b>fox</b> jumps <span style="position:relative;top:-10px;">over</span> the <span style="letter-spacing:2px;">lazy</span> dog'}),"short":angular.extend({},d,{text:'The <em>qck</em> <span style="color:brown;">brwn</span> <b>fx</b> jmps <span style="position:relative;top:-10px;">vr</span> th <span style="letter-spacing:2px;">lzy</span> dg'})},a.filteredBanners=[],a.banners=c.get(),a.overlayContents="",angular.forEach(a.banners,function(a){a.containerElement="h3"}),a.isFlexiBanner=function(a){return~a.copyType.indexOf("long")&&~a.copyType.indexOf("short")?!0:!1},a.isLongBanner=function(a){return"long"===a.copyType},a.isShortBanner=function(a){return"short"===a.copyType},a.isLongSelected=function(a){return"long"===a.selected},a.isShortSelected=function(a){return"short"===a.selected},a.setVisibleCopy=function(){var b=a.copy.long.bannersVisible,c=a.copy.short.bannersVisible;angular.forEach(a.banners,function(d){c&&!b?(a.isFlexiBanner(d)||a.isShortBanner(d))&&(d.selected="short"):(a.isFlexiBanner(d)||a.isLongBanner(d))&&(d.selected="long")})}}]),angular.module("bannerCopyToolApp").filter("copySizeFilter",function(){return function(a,b,c){var d=[];return b&&c?d=a:b&&!c?angular.forEach(a,function(a){~a.copyType.indexOf("long")&&d.push(a)}):!b&&c&&angular.forEach(a,function(a){~a.copyType.indexOf("short")&&d.push(a)}),d}}),angular.module("bannerCopyToolApp").filter("nameFilter",function(){return function(a,b){var c=[];return b?angular.forEach(a,function(a){~a.name.indexOf(b)&&c.push(a)}):c=a,c}}),String.prototype.supplant||(String.prototype.supplant=function(a){return this.replace(/\{([^{}]*)\}/g,function(b,c){var d=a[c];return"string"==typeof d||"number"==typeof d?d:b})}),angular.module("bannerCopyToolApp").directive("banner",["$interpolate","$compile",function(a,b){return{restrict:"E",replace:!0,templateUrl:"/views/banner.html",link:function(c,d){c.$watch("banner.containerElement",function(){var e={tag:c.banner.containerElement},f=d.find(".copy-text"),g=angular.element(a('<{{ tag }} class="table-cell-middle" ng-bind-html="copy[banner.selected].sanitize()"></{{ tag }}>')(e));g.html("{{ copy[banner.selected].sanitize() }}"),f.html(g),b(f.contents())(c)})}}}]),angular.module("bannerCopyToolApp").directive("markupSwitcher",[function(){return{restrict:"C",scope:{tag:"="},templateUrl:"/views/markup-switcher.html"}}]),angular.module("bannerCopyToolApp").directive("codeRevealer",["$sce",function(a){return{scope:{name:"@",overlayContents:"=",data:"="},templateUrl:function(a,b){return b.type?"/views/code-revealer-"+b.type+".html":"/views/code-revealer-individual.html"},restrict:"C",link:function(b,c,d){var e=function(a){return a.replace(/ng-(scope|binding|bind-html="[\w\(\)\.\[\]]+")/g,"")};c.click(function(f){if($(f.target).is(c.find("button"))){var g,h="";"all"===d.type?angular.forEach(b.data,function(a,c){g=$(d.selectorPrefix+a.name+" .copy-text"),h+=e(g.html()),c<b.data.length-1&&(h+="\n\n")}):"individual"!==d.type&&d.type||(g=$(d.selector+" .copy-text"),h=e(g.html())),b.$apply(function(){b.overlayContents=a.trustAsHtml("<textarea>"+h+"</textarea>")})}f.preventDefault()})}}}]),angular.module("bannerCopyToolApp").directive("overlay",function(){return{scope:{contents:"="},restrict:"C",templateUrl:"/views/overlay.html",link:function(a,b){function c(){b.toggleClass("hidden")}function d(a){var c=/^<(textarea|input)/,d=a.toString().match(c);d&&d[1]&&b.find(d[1])[0].select()}b.click(function(a){var d=$(a.target);(d.is(b)||d.is("a"))&&c(),a.preventDefault()}),$("body").keyup(function(a){27!==a.keyCode||b.hasClass("hidden")||c(),a.preventDefault()}),a.$watch("contents",function(a,b){a!==b&&(c(),d(a))})}}});